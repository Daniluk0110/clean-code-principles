# Fail-Fast ‚ö°Ô∏è

## –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç üß≠
Fail-Fast ‚Äî –ø—Ä–∏–Ω—Ü–∏–ø, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —Å–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –æ—à–∏–±–∫—É –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–∞–Ω—å—à–µ –∏ —Å—Ä–∞–∑—É –æ –Ω–µ–π —Å–æ–æ–±—â–∞–µ—Ç. –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –∏—Å–∫–ª—é—á–µ–Ω–∏—é –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ –∏–ª–∏ –Ω–∞ –≤—Ö–æ–¥–µ –≤ –º–µ—Ç–æ–¥, –∞ –Ω–µ –Ω–∞ —ç—Ç–∞–ø–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–ª–∞—Ç—ë–∂–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –¢–∞–∫ –≤—ã –ª–æ–≤–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–µ—Å—Ç–µ –∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.

## –ê–Ω–∞–ª–æ–≥–∏—è üçΩÔ∏è
–õ—É—á—à–µ –ø–æ–ª—É—á–∏—Ç—å –æ—à–∏–±–∫—É –Ω–∞ –≤—Ö–æ–¥–µ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω: "–º–µ—Å—Ç –Ω–µ—Ç", —á–µ–º —Å–µ—Å—Ç—å, –∑–∞–∫–∞–∑–∞—Ç—å, –ø–æ–¥–æ–∂–¥–∞—Ç—å —á–∞—Å –∏ —É–∑–Ω–∞—Ç—å, —á—Ç–æ –±–ª—é–¥–∞ –Ω–µ –±—É–¥–µ—Ç.

## –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ ‚úÖ
- –ë—ã—Å—Ç—Ä–µ–µ –Ω–∞—Ö–æ–¥–∏—Ç–µ –¥–µ—Ñ–µ–∫—Ç—ã: –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –≤ —Ç–æ—á–∫–µ –≤—Ö–æ–¥–∞ —è—Å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏—á–∏–Ω—É.
- –£–º–µ–Ω—å—à–∞–µ—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ—à–∏–±–∫–∏: –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤.
- –£–ø—Ä–æ—â–∞–µ—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∫—É: –∫–æ–¥ —á–∏—Ç–∞–µ—Ç—Å—è –ª–∏–Ω–µ–π–Ω–æ, –±–µ–∑ —Å–∫—Ä—ã—Ç—ã—Ö –ª–æ–≤—É—à–µ–∫.

## –ó–∞–ø–∞—Ö–∏ –∫–æ–¥–∞ üß™
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –º–µ—Ç–æ–¥–∞, –∫–æ–≥–¥–∞ —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç—ã —É–∂–µ —Å–¥–µ–ª–∞–Ω–∞.
- –í–æ–∑–≤—Ä–∞—Ç `null` –≤–º–µ—Å—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —è–≤–Ω–æ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
- Silent failures: –ø–æ–π–º–∞–ª –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–¥–µ–ª–∞–ª.

## ‚ùå –ë—ã–ª–æ (–ü–ª–æ—Ö–æ)
–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ 15-–π —Å—Ç—Ä–æ–∫–µ, –∫–æ–≥–¥–∞ —É–∂–µ –±—ã–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ API:

```php
public function chargeCustomer(int $customerId, float $amount): void
{
    $this->paymentApi->reserveSlot($customerId);
    $this->paymentApi->prepareCharge($customerId, $amount);

    if ($amount <= 0) {
        throw new \InvalidArgumentException('Amount must be positive.');
    }

    $this->paymentApi->charge($customerId, $amount);
}
```

## ‚úÖ –°—Ç–∞–ª–æ (–•–æ—Ä–æ—à–æ)
–í–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ Money Value Object –∏ guard clauses –≤ –Ω–∞—á–∞–ª–µ –º–µ—Ç–æ–¥–∞ ‚Äî –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∫–∏–¥–∞–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ:

```php
public function chargeCustomer(int $customerId, Money $amount): void
{
    Guard::positiveInt($customerId, 'customerId');

    $this->paymentApi->charge($customerId, $amount->asFloat());
}
```

## Exception vs Error –≤ PHP 8.4 üßØ
- Exception ‚Äî —ç—Ç–æ –æ–∂–∏–¥–∞–µ–º—ã–µ –æ—à–∏–±–∫–∏ —É—Ä–æ–≤–Ω—è –¥–æ–º–µ–Ω–∞/–≤–∞–ª–∏–¥–∞—Ü–∏–∏: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –Ω–∞—Ä—É—à–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é. –ò—Ö –º–æ–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.
- Error ‚Äî —ç—Ç–æ –æ—à–∏–±–∫–∏ —É—Ä–æ–≤–Ω—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∏–ª–∏ —Ñ–∞—Ç–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è: –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–∏–ø–∞–º–∏, –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –º–µ—Ç–æ–¥–∞–º, –æ—à–∏–±–∫–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞. –ò—Ö, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –Ω–µ —Å–ª–µ–¥—É–µ—Ç –ª–æ–≤–∏—Ç—å –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

–í fail-fast –≤—ã –±—Ä–æ—Å–∞–µ—Ç–µ Exception (–Ω–∞–ø—Ä–∏–º–µ—Ä, InvalidArgumentException) –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. Error –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö –æ—à–∏–±–æ–∫ –∏–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–±–æ–µ–≤.

## –ú–∏–Ω–∏-—á–µ–∫–ª–∏—Å—Ç üîé
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–µ—Ä–≤—ã—Ö —Å—Ç—Ä–æ–∫–∞—Ö –º–µ—Ç–æ–¥–∞.
- –í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ value object.
- –ù–µ –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
